{% extends 'base.html' %}

{% block content %}
<div class="dashboard">
  <div class="reserve-action card-container">
    <h1 class="gradient-text">完了</h1>
    <p>今日の記録を残しましょう</p>

    <form method="post" class="custom-form">
      {% csrf_token %}

      <div class="form-group">
        <label for="{{ form.activity_type.id_for_label }}">種別（必須）</label>
        {{ form.activity_type }} {% for e in form.activity_type.errors %}<p class="error">{{ e }}</p>{% endfor %}
      </div>

      <div class="form-group">
        <label for="{{ form.memo.id_for_label }}">メモ（任意）</label>
        {{ form.memo }}
        {% for e in form.memo.errors %}<p class="error">{{ e }}</p>{% endfor %}
      </div>

      <div class="form-check">
        <label for="{{ form.share_detail.id_for_label }}">
          {{ form.share_detail }}
          <span>詳細をタイムラインに投稿する</span>
        </label>
      </div>

      <button type="submit" class="reserve-btn full-width">完了する</button>
    </form>
  </div>
</div>

<script>
  window.addEventListener('DOMContentLoaded', () => {
    // URLから "?time=00:15:00" の部分を取得
    const urlParams = new URLSearchParams(window.location.search);
    const timeSpent = urlParams.get('time');

    const memoField = document.querySelector('textarea[name="memo"]');
    if (timeSpent && memoField) {
      memoField.value = `運動時間：${timeSpent}\n` + memoField.value;
    }
  });
</script>

{% endblock %}