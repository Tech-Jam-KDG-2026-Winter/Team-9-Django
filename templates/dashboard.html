<h2>ホーム</h2>
<h1>今日の予約</h1>

{% if reservation_items %}
  {% for item in reservation_items %}
    <div>
      <p>{{ item.reservation.start_at }}</p>

      {% if item.reservation.status == "completed" %}
        <span>達成</span>

      {% elif item.reservation.status == "recovery" %}
        <span>リカバリー済み</span>

      {% elif item.checked_in %}
        <span>チェックイン済み</span>

      {% elif item.can_checkin %}
        <form method="post" action="{% url 'reservation_checkin' item.reservation.id %}">
          {% csrf_token %}
          <button type="submit">チェックイン</button>
        </form>

      {% else %}
        <span>まだ</span>
      {% endif %}

      {# リカバリー使用ボタン #}
      {% if item.reservation.status == "missed" and not item.reservation.used_recovery %}
        <form method="post" action="{% url 'reservation_recovery' item.reservation.id %}">
          {% csrf_token %}
          <button type="submit">リカバリー使用</button>
        </form>
      {% endif %}
    </div>
  {% endfor %}
{% else %}
  <p>今日の予約はありません</p>
{% endif %}
